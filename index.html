<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Klarna On-Site Messaging Gallery</title>
    <style>
        body {
            font-family: 'MS Sans Serif', Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #008080;
            color: #000;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #c0c0c0;
            padding: 20px;
            border: 2px solid #fff;
            box-shadow: inset -2px -2px #808080, inset 2px 2px #dfdfdf;
        }
        h1, h2, h3 {
            color: #000;
            text-shadow: 1px 1px #fff;
        }
        h1 {
            background-color: #000080;
            color: #fff;
            padding: 10px;
            text-shadow: none;
        }
        .widget-container {
            margin-bottom: 30px;
            border: 2px solid #808080;
            padding: 20px;
            background-color: #fff;
            box-shadow: inset -2px -2px #dfdfdf, inset 2px 2px #808080;
        }
        .widget-description {
            margin-bottom: 10px;
            font-style: italic;
        }
        #country-selector, #purchase-amount {
            margin-bottom: 20px;
            padding: 5px;
            font-size: 16px;
            border: 2px solid #808080;
            background-color: #fff;
            box-shadow: inset -1px -1px #dfdfdf, inset 1px 1px #808080;
        }
        label {
            display: inline-block;
            margin-right: 10px;
            font-weight: bold;
        }
        .control-group {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #ffe1ed;
            border: 2px solid #ff69b4;
            box-shadow: inset -2px -2px #dfdfdf, inset 2px 2px #808080;
        }
        #currency-symbol {
            font-weight: bold;
            margin-right: 5px;
        }
        button {
            background-color: #c0c0c0;
            border: 2px solid #808080;
            box-shadow: inset -2px -2px #808080, inset 2px 2px #fff;
            padding: 5px 10px;
            cursor: pointer;
        }
        button:active {
            box-shadow: inset 2px 2px #808080, inset -2px -2px #fff;
        }
        .controls-container {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .control-group {
            flex: 1;
            margin-right: 10px;
            padding: 10px;
            background-color: #ffe1ed;
            border: 2px solid #ff69b4;
            box-shadow: inset -2px -2px #dfdfdf, inset 2px 2px #808080;
        }
        .control-group:last-child {
            margin-right: 0;
        }
        #purchase-amount {
            width: calc(100% - 30px); /* Adjust based on currency symbol width */
        }
        .mode-selector {
            margin-left: 10px;
        }
        .dark-mode {
            background-color: #333;
            color: #fff;
        }

        select, input[type="number"], button {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            padding: 2px 5px;
            font-family: 'MS Sans Serif', Arial, sans-serif;
            font-size: 11px;
            color: #000;
        }

        select {
            background-image: url("data:image/svg+xml,%3Csvg width='10' height='5' viewBox='0 0 10 5' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0L5 5L10 0H0Z' fill='black'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 5px center;
            padding-right: 20px;
        }

        select:focus, input[type="number"]:focus, button:focus {
            outline: 1px dotted #000;
            outline-offset: -4px;
        }

        input[type="number"] {
            border-left: none;
        }

        #currency-symbol {
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            padding: 2px 5px;
            margin-right: 0;
            font-size: 11px;
        }

        .button-group {
            display: flex;
        }

        .button-group button {
            flex: 1;
            padding: 3px 8px;
            font-family: 'MS Sans Serif', Arial, sans-serif;
            font-size: 11px;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            background-color: #c0c0c0;
            cursor: pointer;
        }

        .button-group button.active {
            border-color: #808080 #dfdfdf #dfdfdf #808080;
            box-shadow: inset 1px 1px #000;
        }

        .button-group button:not(.active):hover {
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
        }

        .control-group {
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            padding: 8px;
        }

        .controls-container {
            background-color: #c0c0c0;
            padding: 8px;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
        }

        label {
            font-size: 11px;
            margin-bottom: 2px;
            display: block;
        }

        /* Adjust the container style */
        .container {
            background-color: #c0c0c0;
            border: 2px solid;
            border-color: #dfdfdf #808080 #808080 #dfdfdf;
            padding: 2px;
        }

        /* Style for the title bar */
        h1 {
            background: linear-gradient(to right, #000080, #1084d0);
            color: #fff;
            padding: 2px 4px;
            font-size: 11px;
            font-weight: bold;
            margin: 0 0 2px 0;
        }
    </style>
</head>
<body>
    <script
      async
      data-environment="playground"
      src="https://js.klarna.com/web-sdk/v1/klarna.js"
      data-client-id="klarna_test_client_JDYjbjVXWGdkJEopJXBMY2xSa20lejJXTHlSJFVaR0gsYWFjZWUwZmUtMzIwMC00NzhhLTg1YmUtZjA0MTFlYzM3NTI2LDEsVzlrWWRoY1REU1dBRXFTMkw2dVNYakZhSjlsM01QUjlrNVV4MjhPZk8vdz0"
    ></script>

    <div class="container">
        <h1>Klarna On-Site Messaging Gallery</h1>
        <p>This gallery showcases various Klarna On-Site Messaging widgets to inform customers about flexible payment options. 
           <a href="https://x.klarnacdn.net/merchant-vcn/peek/releases/latest/index.html#/autologin" target="_blank">Learn more</a> about Klarna On-Site Messaging.</p>

        <div class="controls-container">
            <div class="control-group country-language">
                <div>
                    <label for="country-selector">Country:</label>
                    <select id="country-selector">
                        <option value="en-AU">Australia</option>
                        <option value="de-AT">Austria</option>
                        <option value="nl-BE">Belgium</option>
                        <option value="en-CA">Canada</option>
                        <option value="cs-CZ">Czech Republic</option>
                        <option value="da-DK">Denmark</option>
                        <option value="fi-FI">Finland</option>
                        <option value="fr-FR">France</option>
                        <option value="de-DE">Germany</option>
                        <option value="el-GR">Greece</option>
                        <option value="en-IE">Ireland</option>
                        <option value="it-IT">Italy</option>
                        <option value="es-MX">Mexico</option>
                        <option value="nl-NL">Netherlands</option>
                        <option value="en-NZ">New Zealand</option>
                        <option value="nb-NO">Norway</option>
                        <option value="pl-PL">Poland</option>
                        <option value="pt-PT">Portugal</option>
                        <option value="ro-RO">Romania</option>
                        <option value="es-ES">Spain</option>
                        <option value="sv-SE">Sweden</option>
                        <option value="de-CH">Switzerland</option>
                        <option value="en-GB">United Kingdom</option>
                        <option value="en-US">United States</option>
                    </select>
                </div>
                <div>
                    <label for="language-selector">Language:</label>
                    <select id="language-selector">
                        <option value="local">Local</option>
                        <option value="en">English</option>
                    </select>
                </div>
            </div>

            <div class="control-group">
                <label for="purchase-amount">Purchase Amount:</label>
                <span id="currency-symbol">$</span>
                <input type="number" id="purchase-amount" value="100.00" min="0" step="0.01">
            </div>

            <div class="control-group mode-selector">
                <label>Dark Mode:</label>
                <div class="button-group">
                    <button id="dark-mode-disable" class="active">Disabled</button>
                    <button id="dark-mode-enable">Enabled</button>
                </div>
            </div>
        </div>

        <div class="widget-container">
            <h2>Product Page Widgets</h2>
            <div class="widget-description">
                These widgets show payment options for a specific product price.
            </div>
            <h3>Credit Promotion Badge</h3>
            <klarna-placement data-key="credit-promotion-badge" data-locale="en-US" data-purchase-amount="10000"></klarna-placement>
            
            <h3>Credit Promotion Auto-size</h3>
            <klarna-placement data-key="credit-promotion-auto-size" data-locale="en-US" data-purchase-amount="10000"></klarna-placement>
        </div>

        <div class="widget-container">
            <h2>Homepage Widgets</h2>
            <div class="widget-description">
                These widgets provide general information about Klarna payment options for the homepage.
            </div>
            <h3>Top Strip Promotion Badge</h3>
            <klarna-placement data-key="top-strip-promotion-badge" data-locale="en-US"></klarna-placement>
            
            <h3>Top Strip Promotion Auto-size</h3>
            <klarna-placement data-key="top-strip-promotion-auto-size" data-locale="en-US"></klarna-placement>

            <h3>Sidebar Promotion Auto-size</h3>
            <klarna-placement data-key="sidebar-promotion-auto-size" data-locale="en-US"></klarna-placement>

            <h3>Homepage Promotion Wide</h3>
            <klarna-placement data-key="homepage-promotion-wide" data-locale="en-US"></klarna-placement>

            <h3>Homepage Promotion Tall</h3>
            <klarna-placement data-key="homepage-promotion-tall" data-locale="en-US"></klarna-placement>

            <h3>Homepage Promotion Box</h3>
            <klarna-placement data-key="homepage-promotion-box" data-locale="en-US"></klarna-placement>
        </div>

        <div class="widget-container">
            <h2>Cart Page Widgets</h2>
            <div class="widget-description">
                These widgets show payment options based on the current cart total.
            </div>
            <h3>Credit Promotion Badge</h3>
            <klarna-placement data-key="credit-promotion-badge" data-locale="en-US" data-purchase-amount="10000"></klarna-placement>
            
            <h3>Credit Promotion Auto-size</h3>
            <klarna-placement data-key="credit-promotion-auto-size" data-locale="en-US" data-purchase-amount="10000"></klarna-placement>
        </div>

        <div class="widget-container">
            <h2>Footer Widget</h2>
            <div class="widget-description">
                This widget displays payment options and Klarna information in the footer.
            </div>
            <klarna-placement data-key="footer-promotion-auto-size" data-locale="en-US"></klarna-placement>
        </div>

        <div class="widget-container">
            <h2>FAQs Widget</h2>
            <div class="widget-description">
                This widget provides information for frequently asked questions about Klarna.
            </div>
            <klarna-placement data-key="info-page" data-locale="en-US"></klarna-placement>
        </div>
    </div>

    <script src="https://x.klarnacdn.net/kp/lib/v1/api.js" async></script>

    <script>
        const currencySymbols = {
            'en-AU': 'A$', 'de-AT': '€', 'nl-BE': '€', 'en-CA': 'C$',
            'cs-CZ': 'Kč', 'da-DK': 'kr', 'fi-FI': '€', 'fr-FR': '€',
            'de-DE': '€', 'el-GR': '€', 'en-IE': '€', 'it-IT': '€',
            'es-MX': '$', 'nl-NL': '€', 'en-NZ': 'NZ$', 'nb-NO': 'kr',
            'pl-PL': 'zł', 'pt-PT': '€', 'ro-RO': 'lei', 'es-ES': '€',
            'sv-SE': 'kr', 'de-CH': 'CHF', 'en-GB': '£', 'en-US': '$'
        };

        const countryLanguages = {
            'AU': {local: 'en', name: 'English'},
            'AT': {local: 'de', name: 'Deutsch'},
            'BE': {local: 'nl', name: 'Nederlands'},
            'CA': {local: 'en', name: 'English'},
            'CZ': {local: 'cs', name: 'Čeština'},
            'DK': {local: 'da', name: 'Dansk'},
            'FI': {local: 'fi', name: 'Suomi'},
            'FR': {local: 'fr', name: 'Français'},
            'DE': {local: 'de', name: 'Deutsch'},
            'GR': {local: 'el', name: 'Ελληνικά'},
            'IE': {local: 'en', name: 'English'},
            'IT': {local: 'it', name: 'Italiano'},
            'MX': {local: 'es', name: 'Español'},
            'NL': {local: 'nl', name: 'Nederlands'},
            'NZ': {local: 'en', name: 'English'},
            'NO': {local: 'nb', name: 'Norsk'},
            'PL': {local: 'pl', name: 'Polski'},
            'PT': {local: 'pt', name: 'Português'},
            'RO': {local: 'ro', name: 'Română'},
            'ES': {local: 'es', name: 'Español'},
            'SE': {local: 'sv', name: 'Svenska'},
            'CH': {local: 'de', name: 'Deutsch'},
            'GB': {local: 'en', name: 'English'},
            'US': {local: 'en', name: 'English'}
        };

        const darkModeCompatibleWidgets = [
            "credit-promotion-badge",
            "credit-promotion-auto-size",
            "top-strip-promotion-badge",
            "top-strip-promotion-auto-size",
            "footer-promotion-auto-size",
            "info-page",
            "homepage-promotion-wide",
            "homepage-promotion-tall",
            "homepage-promotion-box"
        ];

        function updateLanguageSelector(countryCode) {
            const languageSelector = document.getElementById('language-selector');
            const localLanguage = countryLanguages[countryCode].local;
            const localLanguageName = countryLanguages[countryCode].name;
            
            languageSelector.innerHTML = `
                <option value="${localLanguage}">${localLanguageName}</option>
                <option value="en">English</option>
            `;
        }

        function updateWidgets() {
            const selectedCountry = document.getElementById('country-selector').value.split('-')[1];
            const selectedLanguage = document.getElementById('language-selector').value;
            const purchaseAmount = parseFloat(document.getElementById('purchase-amount').value);
            const minorUnitAmount = Math.round(purchaseAmount * 100);
            const isDarkModeEnabled = document.getElementById('dark-mode-enable').classList.contains('active');

            const locale = selectedLanguage === 'en' && selectedLanguage !== countryLanguages[selectedCountry].local
                ? `en-${selectedCountry}`
                : `${selectedLanguage}-${selectedCountry}`;

            document.getElementById('currency-symbol').textContent = currencySymbols[locale];

            document.querySelectorAll('klarna-placement').forEach(placement => {
                placement.setAttribute('data-locale', locale);
                if (placement.hasAttribute('data-purchase-amount')) {
                    placement.setAttribute('data-purchase-amount', minorUnitAmount);
                }

                const widgetKey = placement.getAttribute('data-key');
                if (darkModeCompatibleWidgets.includes(widgetKey)) {
                    if (isDarkModeEnabled) {
                        placement.setAttribute('data-theme', 'dark');
                    } else {
                        placement.removeAttribute('data-theme');
                    }
                }
            });

            // Refresh Klarna placements
            window.KlarnaOnsiteService = window.KlarnaOnsiteService || [];
            window.KlarnaOnsiteService.push({ eventName: 'refresh-placements' });
        }

        document.getElementById('country-selector').addEventListener('change', (event) => {
            const selectedCountry = event.target.value.split('-')[1];
            updateLanguageSelector(selectedCountry);
            updateWidgets();
        });
        document.getElementById('language-selector').addEventListener('change', updateWidgets);
        document.getElementById('purchase-amount').addEventListener('input', updateWidgets);

        // Add event listeners for dark mode buttons
        document.getElementById('dark-mode-enable').addEventListener('click', function() {
            this.classList.add('active');
            document.getElementById('dark-mode-disable').classList.remove('active');
            updateWidgets();
        });

        document.getElementById('dark-mode-disable').addEventListener('click', function() {
            this.classList.add('active');
            document.getElementById('dark-mode-enable').classList.remove('active');
            updateWidgets();
        });

        // Initialize with default values
        const defaultCountry = document.getElementById('country-selector').value.split('-')[1];
        updateLanguageSelector(defaultCountry);
        updateWidgets();
    </script>
</body>
</html>
